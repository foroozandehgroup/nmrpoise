
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Installation &#8212; poise  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="Setting up a Routine" href="../routines/" />
    <link rel="prev" title="POISE User Guide" href="../" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>POISE comprises a <em>frontend</em> script, which is accessible from within TopSpin itself, as well as a <em>backend</em> script, which has to be run using Python 3 (i.e. not TopSpin’s native Python interpreter).</p>
<p>The requirements are:</p>
<blockquote>
<div><ul>
<li><p><strong>TopSpin</strong>. We have tested TopSpin versions 3.6 and 4.0 thoroughly. Older versions of TopSpin are not guaranteed to work: they <em>should</em>, however, work as long as the Python version <em>inside</em> TopSpin is 2.7.</p>
<p>To check the TopSpin Python version, you can create a new Python script in TopSPin (<code class="docutils literal notranslate"><span class="pre">edpy</span></code>), enter the following, and execute it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span><span class="p">;</span> <span class="n">MSG</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">)</span>
</pre></div>
</div>
<p>If the resulting version number starts with 2.7, you should be good to go.</p>
</li>
<li><p><strong>Python 3</strong>. This refers to a separate, system installation of Python 3; in particular, POISE requires a minimum version of <strong>Python 3.6.</strong> (We have tested up to Python 3.9.)</p>
<p>For Windows, your best bet is to download an installer from <a class="reference external" href="https://www.python.org/downloads/">the Python website</a>.
For macOS and Linux, we suggest using a package manager to do so (such as Homebrew for macOS or <code class="docutils literal notranslate"><span class="pre">apt</span></code>/<code class="docutils literal notranslate"><span class="pre">yum</span></code> &amp; their equivalents on Linux), although the installers are also fine.</p>
</li>
</ul>
</div></blockquote>
<p>Once that’s done, you can install POISE using <code class="docutils literal notranslate"><span class="pre">pip</span></code> (replace <code class="docutils literal notranslate"><span class="pre">python</span></code> with <code class="docutils literal notranslate"><span class="pre">python3</span></code> if necessary):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">nmrpoise</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pip</span></code> tries to take care of installing the scripts to your TopSpin directory.
To do so, it checks for TopSpin installations in standard directories (<code class="docutils literal notranslate"><span class="pre">/opt</span></code> on Unix and <code class="docutils literal notranslate"><span class="pre">C:\Bruker</span></code> on Windows).
If <code class="docutils literal notranslate"><span class="pre">pip</span></code> exits without errors, this should have succeeded; you can test it by typing <code class="docutils literal notranslate"><span class="pre">poise</span> <span class="pre">-h</span></code> into TopSpin’s command-line, which should spawn a popup.
If that is the case, congratulations — you can move on to the next chapter, <a class="reference internal" href="../routines/"><span class="doc">Setting up a Routine</span></a>.</p>
<section id="updating-poise">
<h2>Updating POISE<a class="headerlink" href="#updating-poise" title="Permalink to this headline">¶</a></h2>
<p>Simply use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">nmrpoise</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">cache</span><span class="o">-</span><span class="nb">dir</span>
</pre></div>
</div>
<p>(again replacing <code class="docutils literal notranslate"><span class="pre">python</span></code> with <code class="docutils literal notranslate"><span class="pre">python3</span></code> if necessary). All other steps (including troubleshooting, if necessary) are the same.</p>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<p>If you are reinstalling POISE (either using the <code class="docutils literal notranslate"><span class="pre">--upgrade</span></code> flag, or after uninstalling it), make sure to add the <code class="docutils literal notranslate"><span class="pre">--no-cache-dir</span></code> flag to <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code>.
In other words, run <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">nmrpoise</span> <span class="pre">--no-cache-dir</span></code>.
(The reason for this is because if <code class="docutils literal notranslate"><span class="pre">pip</span></code> uses a pre-built wheel to install POISE, the TopSpin files will not be installed.
When POISE is installed for the first time, <code class="docutils literal notranslate"><span class="pre">pip</span></code> will create a wheel, and subsequent installations will use the wheel and fail to install the TopSpin files, <em>unless</em> the <code class="docutils literal notranslate"><span class="pre">-no-cache-dir</span></code> flag is passed.
There is a <a class="reference external" href="https://stackoverflow.com/q/58289062/7115316">possible workaround</a> for this to prevent wheels from ever being built, but even though this allows installation to complete successfully, it shows the user some scary red text in the process, which I’d rather not.)</p>
<p>Apart from this, the installation can occasionally fail if TopSpin is installed to a non-standard location.
To solve this issue, you can specify the TopSpin installation directory as an environment variable <code class="docutils literal notranslate"><span class="pre">TSDIR</span></code> before installing POISE.
The way to do this depends on what operating system (and shell) you use.</p>
<p>On Windows PowerShell, run the following command:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$env:TSDIR</span> <span class="p">=</span> <span class="s2">&quot;C:\Bruker\TopSpinX.Y.Z\exp\stan\nmr&quot;</span>
</pre></div>
</div>
<p>replacing the part in quotes with your actual TopSpin installation directory (it must point to the <code class="docutils literal notranslate"><span class="pre">exp/stan/nmr</span></code> folder).</p>
<p>On old-school Windows <code class="docutils literal notranslate"><span class="pre">cmd</span></code>, use:</p>
<div class="highlight-batch notranslate"><div class="highlight"><pre><span></span><span class="k">set</span> <span class="nv">TSDIR</span><span class="p">=</span><span class="s2">&quot;C:\Bruker\TopSpinX.Y.Z\exp\stan\nmr&quot;</span>
</pre></div>
</div>
<p>On Unix systems, use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">TSDIR</span><span class="o">=</span><span class="s2">&quot;/opt/topspinX.Y.Z/exp/stan/nmr&quot;</span>
</pre></div>
</div>
<p>(Unless you’re using <code class="docutils literal notranslate"><span class="pre">csh</span></code> or the like, in which case you use <code class="docutils literal notranslate"><span class="pre">setenv</span></code>, although you probably didn’t need to be told that!)</p>
<p>After running the appropriate command for your operating system, <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">nmrpoise</span></code> should be able to detect the <code class="docutils literal notranslate"><span class="pre">TSDIR</span></code> environment variable and install the scripts accordingly.</p>
</section>
<section id="from-source">
<h2>From source<a class="headerlink" href="#from-source" title="Permalink to this headline">¶</a></h2>
<p>If you obtained the source code (e.g. from <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span></code> or a <a class="reference external" href="https://github.com/foroozandehgroup/nmrpoise/releases">GitHub release</a>) and want to install from there, simply <code class="docutils literal notranslate"><span class="pre">cd</span></code> into the top-level <code class="docutils literal notranslate"><span class="pre">nmrpoise</span></code> directory and run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">.</span>
</pre></div>
</div>
<p>or equivalently:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<p>The installation to the TopSpin directory is subject to the same considerations as above.</p>
</section>
<section id="without-an-internet-connection">
<h2>Without an internet connection<a class="headerlink" href="#without-an-internet-connection" title="Permalink to this headline">¶</a></h2>
<p>If your spectrometer does not have an Internet connection, then the installation becomes a bit more protracted.
On a computer that <em>does</em> have an Internet connection:</p>
<ol class="arabic">
<li><p>Make a new folder.</p></li>
<li><p>Download the CPython installer for the spectrometer operating system. Place it in that folder.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cd</span></code> to the folder and run these commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">download</span> <span class="n">Py</span><span class="o">-</span><span class="n">BOBYQA</span> <span class="n">nmrpoise</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">deps</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">binary</span><span class="o">=</span><span class="p">:</span><span class="nb">all</span><span class="p">:</span>
<span class="n">pip</span> <span class="n">download</span> <span class="n">numpy</span> <span class="n">pandas</span> <span class="n">scipy</span> <span class="o">--</span><span class="n">only</span><span class="o">-</span><span class="n">binary</span><span class="o">=</span><span class="p">:</span><span class="nb">all</span><span class="p">:</span> <span class="o">--</span><span class="n">python</span><span class="o">-</span><span class="n">version</span> <span class="o">&lt;</span><span class="mf">3.</span><span class="n">X</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">platform</span> <span class="o">&lt;</span><span class="n">PLATFORM</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">&lt;3.X&gt;</span></code> is the version of Python to be installed on the spectrometer, and <code class="docutils literal notranslate"><span class="pre">&lt;PLATFORM&gt;</span></code> is one of <code class="docutils literal notranslate"><span class="pre">win32</span></code>, <code class="docutils literal notranslate"><span class="pre">win_amd64</span></code>, <code class="docutils literal notranslate"><span class="pre">macosx_10_9_x86_64</span></code>, or <code class="docutils literal notranslate"><span class="pre">manylinux1_x86_64</span></code> depending on the spectrometer operating system. (n.b. These options are not well-documented; I have figured them out by trawling Stack Overflow. Any additions are welcome.)</p>
</li>
<li><p>Copy the whole folder over to your spectrometer. It should contain a bunch of <code class="docutils literal notranslate"><span class="pre">.whl</span></code> files and two <code class="docutils literal notranslate"><span class="pre">.tar.gz</span></code> files.</p></li>
</ol>
<p>Now, on the spectrometer:</p>
<ol class="arabic">
<li><p>Install CPython with the installer.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cd</span></code> to the folder and run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">./</span><span class="n">nmrpoise</span><span class="o">-&lt;</span><span class="n">VERSION</span><span class="o">&gt;.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">index</span> <span class="o">--</span><span class="n">find</span><span class="o">-</span><span class="n">links</span> <span class="o">.</span>
</pre></div>
</div>
<p>(replace <code class="docutils literal notranslate"><span class="pre">&lt;VERSION&gt;</span></code> with whichever version you downloaded).</p>
</li>
</ol>
<p>It should then install properly, unless your TopSpin installation location is non-standard: in that case, set the <code class="docutils literal notranslate"><span class="pre">$TSDIR</span></code> environment variable (described above) before retrying Step 2.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../">poise</a></h1>








<p></p>
<h3>Useful links</h3>
<ul>
    <li><a href="https://doi.org/10.1021/acs.analchem.1c01767">Paper (<i>Anal. Chem.</i> 2021)</a></li>
    <li><a href="https://arxiv.org/abs/2108.07121">arXiv preprint</a></li>
    <li><a href="https://github.com/foroozandehgroup/nmrpoise">GitHub repository</a></li>
    <li><a href="https://www.youtube.com/watch?v=QTCeSCRZs4I">YouTube video guide</a></li>
    <li><a href="https://foroozandehgroup.github.io/nmrpoise">HTML documentation</a></li>
    <li><a href="https://foroozandehgroup.github.io/nmrpoise/poise.pdf">PDF documentation</a></li>
</ul><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#updating-poise">Updating POISE</a></li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#from-source">From source</a></li>
<li class="toctree-l2"><a class="reference internal" href="#without-an-internet-connection">Without an internet connection</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../routines/">Setting up a Routine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running/">Running an optimisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frontend/">Frontend options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../automation/">POISE under automation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../costfunctions/">Builtin cost functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../au/">Builtin AU programmes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../customcf/">Custom cost functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/">Developer notes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../">Documentation overview</a><ul>
      <li>Previous: <a href="../" title="previous chapter">POISE User Guide</a></li>
      <li>Next: <a href="../routines/" title="next chapter">Setting up a Routine</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021–2022, Jonathan Yong & Mohammadali Foroozandeh.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/install.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>